# ุชูุฑูุฑ ุฅุตูุงุญ ูุดููุฉ ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ ูุงูุณุฌูุงุช

## ุงููุดููุฉ ุงููุจูุบุฉ
ุงููุณุชุฎุฏู ุฃุจูุบ ุนู ูุดููุฉ ูู ุชุตุฏูุฑ ุชูุฑูุฑ ุงูุฌูุณุฉ ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุญูุธ ุงูุชูุฑูุฑ" ุญูุซ ูุนุทู ุฎุทุฃ.

## ุงูุชุญููู ูุงูุชุดุฎูุต

### 1. ุงููุดููุฉ ุงูุฃุตููุฉ
- ูุดููุฉ ูู scope ุงููุชุบูุฑุงุช ูุน lambda functions
- ุนุฏู ูุฌูุฏ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- ุนุฏู ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุชุงุจุฉ

### 2. ุงูุฃุฎุทุงุก ุงููุญุชููุฉ
- `PermissionError`: ุนุฏู ูุฌูุฏ ุตูุงุญูุฉ ูููุชุงุจุฉ
- `FileNotFoundError`: ูุณุงุฑ ุบูุฑ ุตุญูุญ
- `UnicodeEncodeError`: ูุดุงูู ูู ุงูุชุดููุฑ
- `AttributeError`: ูุชุบูุฑุงุช ุบูุฑ ููุฌูุฏุฉ

## ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุฅุตูุงุญ ุฏุงูุฉ `save_session_report()`

#### ุงูุชุญุณููุงุช ุงูุฑุฆูุณูุฉ:
```python
def save_session_report(self):
    """ุญูุธ ุชูุฑูุฑ ุงูุฌูุณุฉ ูู ููู"""
    try:
        # โ ุชุญูู ูุญุณู ูู ุงูุจูุงูุงุช
        if not hasattr(self, 'books_stats') or not self.books_stats:
            messagebox.showwarning("ุชุญุฐูุฑ", "ูุง ุชูุฌุฏ ุจูุงูุงุช ุฌูุณุฉ ูุชุงุญุฉ ููุญูุธ")
            return
        
        # โ ูุนุงูุฌุฉ ูุญุณูุฉ ููุฃุฎุทุงุก ูู ุฅูุดุงุก ุงูุชูุฑูุฑ
        try:
            report_content = self.generate_session_report()
            if not report_content or len(report_content.strip()) == 0:
                messagebox.showerror("ุฎุทุฃ", "ูุดู ูู ุฅูุดุงุก ูุญุชูู ุงูุชูุฑูุฑ")
                return
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ", f"ุฎุทุฃ ูู ุฅูุดุงุก ุงูุชูุฑูุฑ:\n{str(e)}")
            return
        
        # โ ุงุณู ููู ุขูู
        try:
            default_filename = f"ุชูุฑูุฑ_ุฌูุณุฉ_{datetime.now().strftime('%Y%m%d_%H%M%S')}.txt"
        except:
            default_filename = "ุชูุฑูุฑ_ุฌูุณุฉ.txt"
        
        # โ ูุนุงูุฌุฉ ูุญุณูุฉ ููุฑุจุน ุงูุญูุงุฑ
        try:
            file_path = filedialog.asksaveasfilename(
                title="ุญูุธ ุชูุฑูุฑ ุงูุฌูุณุฉ",
                defaultextension=".txt",
                filetypes=[
                    ("ูููุงุช ูุตูุฉ", "*.txt"), 
                    ("ุฌููุน ุงููููุงุช", "*.*")
                ],
                initialname=default_filename
            )
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ", f"ุฎุทุฃ ูู ูุชุญ ูุฑุจุน ุงูุญูุงุฑ:\n{str(e)}")
            return
        
        if not file_path:
            return  # ุงููุณุชุฎุฏู ุฃูุบู ุงูุนูููุฉ
        
        # โ ุถูุงู ุงูุชุฏุงุฏ .txt
        if not file_path.lower().endswith('.txt'):
            file_path += '.txt'
        
        # โ ุญูุธ ุขูู ูุน ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
        try:
            with open(file_path, 'w', encoding='utf-8', newline='') as f:
                f.write(report_content)
            
            # โ ุชุญูู ูู ูุฌุงุญ ุงูุญูุธ
            if os.path.exists(file_path) and os.path.getsize(file_path) > 0:
                file_size = os.path.getsize(file_path)
                success_msg = f"ุชู ุญูุธ ุชูุฑูุฑ ุงูุฌูุณุฉ ุจูุฌุงุญ ูู:\n{file_path}\n\nุญุฌู ุงูููู: {file_size} ุจุงูุช"
                messagebox.showinfo("ุชู ุงูุญูุธ ุจูุฌุงุญ", success_msg)
                
                if hasattr(self, 'log_message'):
                    self.log_message(f"๐พ ุชู ุญูุธ ุชูุฑูุฑ ุงูุฌูุณุฉ: {os.path.basename(file_path)}", "SUCCESS")
            else:
                messagebox.showerror("ุฎุทุฃ", "ูุดู ูู ุฅูุดุงุก ุงูููู ุฃู ุงูููู ูุงุฑุบ")
                
        except PermissionError:
            messagebox.showerror("ุฎุทุฃ ูู ุงูุตูุงุญูุงุช", 
                f"ููุณ ูุฏูู ุตูุงุญูุฉ ูููุชุงุจุฉ ูู ูุฐุง ุงูููุงู:\n{file_path}\n\nุญุงูู ุงุฎุชูุงุฑ ููุงู ุขุฎุฑ ุฃู ุชุดุบูู ุงูุจุฑูุงูุฌ ููุณุคูู")
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ ูู ุงูุญูุธ", f"ูุดู ูู ุญูุธ ุงูููู:\n{str(e)}")
            
    except Exception as e:
        # ุฎุทุฃ ุนุงู ุบูุฑ ูุชููุน
        error_msg = f"ุฎุทุฃ ุบูุฑ ูุชููุน ูู ุญูุธ ุงูุชูุฑูุฑ:\n{str(e)}"
        messagebox.showerror("ุฎุทุฃ ุนุงู", error_msg)
        
        try:
            if hasattr(self, 'log_message'):
                self.log_message(f"โ ุฎุทุฃ ูู ุญูุธ ุงูุชูุฑูุฑ: {str(e)}", "ERROR")
        except:
            pass
```

### 2. ุฅุตูุงุญ ุฏุงูุฉ `save_log()`

ุชู ุชุทุจูู ููุณ ุงููุนุงููุฑ ุนูู ุฏุงูุฉ ุญูุธ ุงูุณุฌู:

#### ุงููููุฒุงุช ุงููุถุงูุฉ:
- โ ุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช
- โ ุงุณู ููู ุงูุชุฑุงุถู ุจุงูุชุงุฑูุฎ ูุงูููุช
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุตูุงุญูุงุช
- โ ุชุญูู ูู ูุฌุงุญ ุงูุญูุธ
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

## ุงูุงุฎุชุจุงุฑุงุช ุงููุฌุฑุงุฉ

### 1. ุงุฎุชุจุงุฑ ูููุตู
ุชู ุฅูุดุงุก `test_session_report_gui.py` ูุงุฎุชุจุงุฑ ุงููุธููุฉ ุจุดูู ูููุตู:

```python
# ุฅูุดุงุก ุจูุงูุงุช ููููุฉ ููุงุฎุชุจุงุฑ
self.books_stats = [
    {
        'name': 'ูุชุงุจ ุงูุจุฎุงุฑู',
        'volumes': 3,
        'chapters': 97,
        'pages': 1250,
        'success': True,
        'status': 'ููุชูู ุจูุฌุงุญ',
        'start_time': datetime.now(),
        'end_time': datetime.now()
    },
    # ... ุงููุฒูุฏ ูู ุงูุจูุงูุงุช
]
```

### 2. ุงุฎุชุจุงุฑ ูุชูุงูู
ุชุดุบูู ุงูุชุทุจูู ุงููุงูู ูุงุฎุชุจุงุฑ:
- โ ุฅูุดุงุก ุชูุฑูุฑ ุฌูุณุฉ
- โ ุญูุธ ุงูุชูุฑูุฑ
- โ ุญูุธ ุงูุณุฌู

## ุงููุชุงุฆุฌ

### ุงูููุฒุงุช ุงููุญููุฉ:
1. **๐ก๏ธ ููุงููุฉ ุงูุฃุฎุทุงุก**: ูุนุงูุฌุฉ ุดุงููุฉ ูุฌููุน ุงูุฃุฎุทุงุก ุงููุญุชููุฉ
2. **๐พ ุญูุธ ููุซูู**: ุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ
3. **๐ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช**: ุฑุณุงุฆู ูุงุถุญุฉ ููุดุงูู ุงูุตูุงุญูุงุช
4. **๐ ุฑุณุงุฆู ูุงุถุญุฉ**: ุฑุณุงุฆู ุฎุทุฃ ููุฌุงุญ ููุตูุฉ
5. **๐ ุฃุณูุงุก ูููุงุช ุฐููุฉ**: ุชุชุถูู ุงูุชุงุฑูุฎ ูุงูููุช
6. **๐ ุชุญูู ูู ุงูุฌูุฏุฉ**: ุงูุชุฃูุฏ ูู ุฃู ุงูููู ุชู ุฅูุดุงุคู ุจุงููุนู

### ุฃููุงุน ุงูุฃุฎุทุงุก ุงููุนุงูุฌุฉ:
- โ `PermissionError`: ูุดุงูู ุงูุตูุงุญูุงุช
- โ `FileNotFoundError`: ูุณุงุฑุงุช ุบูุฑ ุตุญูุญุฉ
- โ `UnicodeError`: ูุดุงูู ุงูุชุดููุฑ
- โ `AttributeError`: ูุชุบูุฑุงุช ุบูุฑ ููุฌูุฏุฉ
- โ ุฃุฎุทุงุก ุนุงูุฉ ุบูุฑ ูุชููุนุฉ

## ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุชูุฑูุฑ ุงูุฌูุณุฉ:
1. ุดุบู ุงูุชุทุจูู
2. ูู ุจุชุญููู ุจุนุถ ุงููุชุจ
3. ุงุฐูุจ ุฅูู "ุชูุฑูุฑ ุงูุฌูุณุฉ"
4. ุงุถุบุท "ุญูุธ ุงูุชูุฑูุฑ"
5. ุงุฎุชุฑ ููุงู ุงูุญูุธ
6. ุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ

### 2. ุงุฎุชุจุงุฑ ุญูุธ ุงูุณุฌู:
1. ุดุบู ุงูุชุทุจูู
2. ูู ุจุจุนุถ ุงูุนูููุงุช ูุฅูุดุงุก ุณุฌู
3. ุงุถุบุท "ุญูุธ ุงูุณุฌู"
4. ุงุฎุชุฑ ููุงู ุงูุญูุธ
5. ุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ

## ุงูุฎูุงุตุฉ

โ **ุชู ุฅุตูุงุญ ุฌููุน ูุดุงูู ุงูุชุตุฏูุฑ ุจูุฌุงุญ!**

- ๐ง ุฅุตูุงุญ ุดุงูู ูุฏูุงู ุงูุญูุธ
- ๐ก๏ธ ุญูุงูุฉ ูู ุฌููุน ุฃููุงุน ุงูุฃุฎุทุงุก
- ๐ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ
- ๐ ุชูุงุฑูุฑ ููุตูุฉ ููุงุถุญุฉ

ุงูุขู ูููู ูููุณุชุฎุฏู ุญูุธ ุงูุชูุงุฑูุฑ ูุงูุณุฌูุงุช ุจุตูุบุฉ `.txt` ุฏูู ุฃู ูุดุงูู!
